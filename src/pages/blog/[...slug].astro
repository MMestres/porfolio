---
import Prose from '../../components/blog/Prose.astro';
import { getEntry } from "astro:content";
import LayoutBlog from '../../layouts/LayoutBlog.astro';
// 1. Get the slug from the incoming server request
const { slug } = Astro.params;
if (slug === undefined) {
  throw new Error("Slug is required");
}
// 2. Query for the entry directly using the request slug
const entry = await getEntry("blog", slug);
// 3. Redirect if the entry does not exist
if (entry === undefined) {
  return Astro.redirect("/404");
}
// 4. (Optional) Render the entry to HTML in the template
const { Content } = await entry.render();
---
<LayoutBlog title={`${entry.data.title} | Blog | Manuel Mestres`} description={entry.data.subtitle}>
  <div class="max-w-6xl mx-auto w-full px-4 xl:px-0 pt-24">
    <div class="text-center text-principal flex flex-col gap-2 text-wrap">
      <h1 class="text-4xl lg:text-6xl font-semibold text-primary">{entry.data.title}</h1>
      <p class="text-xl lg:text-2xl">{entry.data.subtitle}</p>
      <p class="text-sm lg:text-normal text-principal/80">
        {entry.data.date.toLocaleString('es-ES', {
        year: 'numeric',
        month: 'long',
        day: 'numeric'
      })}
      </p>
    </div>
    <div class="w-full aspect-vide rounded-lg overflow-hidden border border-background/80 hover:shadow shadow-background/60 transition-all duration-1000 my-6">
      <img src={entry.data.image} alt="Manuel Mestres" class="w-full aspect-vide rounded-lg object-cover object-center hover:scale-125 transition-all duration-1000" />
    </div>
  </div>
  <div class="max-w-6xl mx-auto px-4 xl:px-0 pb-24">
    <Prose>
      <Content />
    </Prose>
  </div>
</LayoutBlog>